From 3dc249cfae55b734773a7bc9d7151fccf43e9f9d Mon Sep 17 00:00:00 2001
From: electrikjesus <electrikjesus@gmail.com>
Date: Sat, 30 Mar 2019 19:26:50 -0400
Subject: [PATCH] Revert "Settings: Add BlissUpdater"

This reverts commit bc37ea2fbd585d377983a9e1decbd64023e72580.
---
 res/values/bliss_strings.xml                  |  6 ---
 res/xml/system_dashboard_fragment.xml         | 11 ----
 .../deviceinfo/DeviceInfoSettings.java        |  2 -
 .../UpdatePreferenceController.java           | 53 -------------------
 .../system/SystemDashboardFragment.java       | 15 +-----
 5 files changed, 1 insertion(+), 86 deletions(-)
 delete mode 100644 src/com/android/settings/deviceinfo/UpdatePreferenceController.java

diff --git a/res/values/bliss_strings.xml b/res/values/bliss_strings.xml
index 239e306257..21a7ffd5f1 100644
--- a/res/values/bliss_strings.xml
+++ b/res/values/bliss_strings.xml
@@ -474,10 +474,4 @@
     <!-- Battery temp -->
     <string name="battery_temp_title">Battery temperature</string>
 
-    <!-- Bliss Updater -->
-    <string name="update_settings_title">Bliss Updater</string>
-    <string name="update_settings_summary">Check for the latest version of the rom</string>
-    <string name="update_package" translatable="false">com.blissroms.updater</string>
-    <string name="update_activity" translatable="false">com.blissroms.updater.UpdatesActivity</string>
-
 </resources>
diff --git a/res/xml/system_dashboard_fragment.xml b/res/xml/system_dashboard_fragment.xml
index 5716dc1bd9..e21efedd55 100644
--- a/res/xml/system_dashboard_fragment.xml
+++ b/res/xml/system_dashboard_fragment.xml
@@ -46,17 +46,6 @@
         <intent android:action="android.settings.BACKUP_AND_RESET_SETTINGS" />
     </Preference>
 
-    <Preference
-        android:key="update_settings"
-        android:title="@string/update_settings_title"
-        android:summary="@string/update_settings_summary"
-        android:icon="@drawable/ic_system_update"
-        android:order="-35">
-        <intent android:action="android.intent.action.MAIN"
-                android:targetPackage="@string/update_package"
-                android:targetClass="@string/update_activity" />
-    </Preference>
-
     <Preference
         android:key="reset_dashboard"
         android:title="@string/reset_dashboard_title"
diff --git a/src/com/android/settings/deviceinfo/DeviceInfoSettings.java b/src/com/android/settings/deviceinfo/DeviceInfoSettings.java
index 8b41813ae9..ece618e8fd 100644
--- a/src/com/android/settings/deviceinfo/DeviceInfoSettings.java
+++ b/src/com/android/settings/deviceinfo/DeviceInfoSettings.java
@@ -31,7 +31,6 @@ import com.android.settings.dashboard.SummaryLoader;
 import com.android.settings.deviceinfo.firmwareversion.FirmwareVersionPreferenceController;
 import com.android.settings.deviceinfo.imei.ImeiInfoPreferenceController;
 import com.android.settings.deviceinfo.simstatus.SimStatusPreferenceController;
-import com.android.settings.deviceinfo.UpdatePreferenceController;
 import com.android.settings.search.BaseSearchIndexProvider;
 import com.android.settings.search.Indexable;
 import com.android.settingslib.core.AbstractPreferenceController;
@@ -138,7 +137,6 @@ public class DeviceInfoSettings extends DashboardFragment implements Indexable {
         controllers.add(new ManualPreferenceController(context));
         //controllers.add(new FeedbackPreferenceController(fragment, context));
         controllers.add(new FccEquipmentIdPreferenceController(context));
-	controllers.add(new UpdatePreferenceController(context));
         controllers.add(
                 new BuildNumberPreferenceController(context, activity, fragment, lifecycle));
         return controllers;
diff --git a/src/com/android/settings/deviceinfo/UpdatePreferenceController.java b/src/com/android/settings/deviceinfo/UpdatePreferenceController.java
deleted file mode 100644
index 14ddc1117a..0000000000
--- a/src/com/android/settings/deviceinfo/UpdatePreferenceController.java
+++ /dev/null
@@ -1,53 +0,0 @@
-/*
- * Copyright (C) 2017 The Android Open Source Project
- * Copyright (C) 2017 The LineageOS Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package com.android.settings.deviceinfo;
-
-import android.content.Context;
-import android.support.v7.preference.Preference;
-import android.content.pm.ApplicationInfo;
-import android.content.pm.PackageManager;
-
-import com.android.settingslib.core.AbstractPreferenceController;
-import com.android.settings.core.PreferenceControllerMixin;
-
-
-public class UpdatePreferenceController extends AbstractPreferenceController implements
-        PreferenceControllerMixin {
-
-    private static final String KEY_UPDATE_SETTING = "update_settings";
-
-    public UpdatePreferenceController(Context context) {
-        super(context);
-    }
-
-    @Override
-    public boolean isAvailable() {
-        String packagename = mContext.getResources().getString(
-                com.android.settings.R.string.update_package);
-        try {
-            ApplicationInfo ai = mContext.getPackageManager().getApplicationInfo(packagename, 0);
-            return true;
-        } catch (PackageManager.NameNotFoundException e) {
-            return false;
-        }
-    }
-
-    @Override
-    public String getPreferenceKey() {
-        return KEY_UPDATE_SETTING;
-    }
-}
diff --git a/src/com/android/settings/system/SystemDashboardFragment.java b/src/com/android/settings/system/SystemDashboardFragment.java
index 86dcc48ea5..1556659fa8 100644
--- a/src/com/android/settings/system/SystemDashboardFragment.java
+++ b/src/com/android/settings/system/SystemDashboardFragment.java
@@ -26,12 +26,9 @@ import com.android.internal.logging.nano.MetricsProto;
 import com.android.settings.R;
 import com.android.settings.backup.BackupSettingsActivityPreferenceController;
 import com.android.settings.dashboard.DashboardFragment;
-import com.android.settings.deviceinfo.UpdatePreferenceController;
 import com.android.settings.search.BaseSearchIndexProvider;
 import com.android.settings.search.Indexable;
-import com.android.settingslib.core.AbstractPreferenceController;
 
-import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.List;
 
@@ -85,16 +82,6 @@ public class SystemDashboardFragment extends DashboardFragment {
         return visibleCount;
     }
 
-    protected List<AbstractPreferenceController> getPreferenceControllers(Context context) {
-        return buildPreferenceControllers(context);
-    }
-
-    private static List<AbstractPreferenceController> buildPreferenceControllers(Context context) {
-        final List<AbstractPreferenceController> controllers = new ArrayList<>();
-        controllers.add(new UpdatePreferenceController(context));
-        return controllers;
-    }
-
     /**
      * For Search.
      */
@@ -117,4 +104,4 @@ public class SystemDashboardFragment extends DashboardFragment {
                     return keys;
                 }
             };
-}
+}
\ No newline at end of file
-- 
2.17.1

