From 0188483fd3ea329d1332388da49927842052a6b8 Mon Sep 17 00:00:00 2001
From: Sen Jiang <senj@google.com>
Date: Wed, 18 Jul 2018 17:27:24 -0700
Subject: [PATCH 29/31] Fix loading ueventd.${ro.hardware}.rc.

Regression introduced in aosp/717324.

Bug: 111543389
Test: device boots further
Change-Id: I4cf57381104aa1a801cf82a42b1c5ae1a2273e89
Merged-In: I4cf57381104aa1a801cf82a42b1c5ae1a2273e89
(cherry picked from commit d76f174a785d2f1c17999a2d23b1fea2a33e4b1e)
---
 init/ueventd.cpp | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/init/ueventd.cpp b/init/ueventd.cpp
index b0306ec48d..312f499153 100644
--- a/init/ueventd.cpp
+++ b/init/ueventd.cpp
@@ -248,7 +248,11 @@ DeviceHandler CreateDeviceHandler() {
      * device node entries (b/34968103)
      */
     std::string hardware = android::base::GetProperty("ro.hardware", "");
-    parser.ParseConfig("/ueventd." + hardware + ".rc");
+    /* 
+     * parser.ParseConfig("/ueventd." + hardware + ".rc");
+     */
+    parser.ParseConfig({"/ueventd.rc", "/vendor/ueventd.rc", "/odm/ueventd.rc",
++                             "/ueventd." + hardware + ".rc"});
 
     auto boot_devices = fs_mgr_get_boot_devices();
     return DeviceHandler(std::move(dev_permissions), std::move(sysfs_permissions),
-- 
2.17.1

